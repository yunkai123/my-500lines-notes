class Filter

    COEFFICIENTS_LOW_0_HZ = {
        alpha: [1, -1.979133761292768, 0.979521463540373],
        beta:  [0.000086384997973502, 0.000172769995947004, 0.000086384997973502]
    }
    COEFFICIENTS_LOW_5_HZ = { # Direct form I, Chebyshev II, type = low-pass, Astop = 2, Fstop = 5, Fs = 100, Direct Form I
        alpha: [1, -1.80898117793047, 0.827224480562408],
        beta:  [0.095465967120306, -0.172688631608676, 0.095465967120306]
    }
    COEFFICIENTS_HIGH_1_HZ = { # Direct form I, Chebyshev II, type = high-pass, Fs = 100, Fstop = 0.5, Astop = 20, order = 2,
        alpha: [1, -1.905384612118461, 0.910092542787947],
        beta:  [0.953986986993339, -1.907503180919730, 0.953986986993339]
    }

    # 过滤接近 0 hz的低通滤波器信号
    def self.low_0_hz(data)
        filter(data, COEFFICIENTS_LOW_0_HZ)
    end

    # 过滤出 5 hz或以下的低通滤波器信号
    def self.low_5_hz(data)
        filter(data, COEFFICIENTS_LOW_5_HZ)
    end

    # 过滤出 1 hz以上的高通滤波器信号
    def self.high_1_hz(data)
        filter(data, COEFFICIENTS_HIGH_1_HZ)
    end

private

    # IIR 过滤器
    def self.filter(data, coefficients)
        filtered_data = [0, 0]
        (2..data.length - 1).each do |i|
            filtered_data << coefficients[:alpha][0] *
                            (data[i] * coefficients[:beta][0] +
                            data[i - 1] * coefficients[:beta][1] +
                            data[i - 2] * coefficients[:beta][2] - 
                            filtered_data[i - 1] * coefficients[:alpha][1] -
                            filtered_data[i - 2] * coefficients[:alpha][2])
        end
        filtered_data
    end

end