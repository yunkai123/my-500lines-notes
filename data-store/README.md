# DogBed数据库（DBDB）

一个像 BDB 或 SQLite 一样使用的键/值存储。它看起来像个沙发，但没那么优雅。

仅追加了基于树的数据存储。对叶的更新会更新祖先节点。公共节点是共享的。更新会从叶到根刷新到磁盘（这样磁盘地址就可以写入父节点），而提交是对超级块的原子更新，它只指向新的根节点。

真正的实现可能会使用B-树（或B+树或B*-树），但这对我们来说不是一个有趣的细节。将提供的朴素二叉树替换为B+/B*树留给读者作为练习。

支持并发（脏）读。支持序列化的完全事务性更新。

## 安装

代码支持 Python 3.8 以上版本。

建议使用 virtualenv 安装依赖并运行:

```
virtualenv env
./env/Scripts/activate
pip install -r requirements.txt
```

## 测试

```
nosetests -v
```

## 扩展点

好的软件可以很容易地以需要扩展的方式进行扩展。本例使用文件锁和字典将树节点持久化到磁盘，但我们可以非常轻松地使用 `msgpack` 和元组来减少磁盘上的数据大小（这会减少IO大小，从而提高性能）。

二叉树节点和算法不同于持久性和提交逻辑，因此应该很容易实现不同的东西，比如B树。